---
title: "Desafio - 05"
author: "Iuri Santos Oliviera"
format: html
editor: visual
---

## Atividade

```{r}
library(RSQLite)
db = dbConnect(SQLite(), "disco.db") # Importa o banco de dados
dbListTables(db) # Mostra as tabelas que há no banco de dados
```

1.  Extraia da tabela albums todas as colunas e todas as linhas e armazene-os em um objeto chamado album_db

```{r}
album_db = dbGetQuery(db, 'SELECT * FROM albums')
head(album_db)
```

2.  Selecione as colunas trackid, name, composer e unitprice. Ordene o objeto resultante por unitprice.

```{r}
sql = 'SELECT trackid, name, composer, unitprice FROM tracks ORDER BY unitprice '
res <- dbGetQuery(db, sql)
head(res)
```

3.  Quais são as cidades de todos os clientes, ordenadas por nome de cidade?

```{r}
sql = 'SELECT DISTINCT city FROM customers ORDER BY city'
ex3b = dbGetQuery(db, sql)
head(ex3b)
```

4.  Quais são todas as músicas do álbum 1?

```{r}
dbGetQuery(db, 'SELECT name, albumid FROM tracks WHERE albumid=1')
```

5.  Limitando-se a 5 registros, após ordenação por nome, quais são os nomes, ID de álbum e ID de mídia de músicas com mídias de tipo 1 ou 2?

```{r}
sql = paste('SELECT name, albumid, mediatypeid FROM tracks', 'WHERE mediatypeid IN (1, 2)', 'ORDER BY name LIMIT 5')
dbGetQuery(db, sql)
```

6.  Quais são as músicas e identificadores de faixa e álbum produzidas pelo artista que identificador 12?

```{r}
sql = paste('SELECT trackid, name, albumid FROM tracks', 'WHERE albumid IN', '(SELECT albumid FROM albums WHERE artistid=12)', 'LIMIT 5')
dbGetQuery(db, sql)
```

7.  Quais são as faixas cujos nomes começam com qualquer caracter seguido de 'ere' e terminam com qualquer expressão?

```{r}
sql = "SELECT trackid, name FROM tracks WHERE name GLOB '?ere*'"
dbGetQuery(db, sql)[1:5,]
```

8.  Quais são as faixas cujos nomes possuem algum dígito?

```{r}
sql = "SELECT trackid, name FROM tracks WHERE name GLOB '*[0-9]*'"
dbGetQuery(db, sql)
```

9.  Quantas faixas por disco?

```{r}
sql = 'SELECT albumid, COUNT(trackid) FROM tracks GROUP BY albumid'
dbGetQuery(db, sql)
```

10. Quantas faixas por disco para o album 1?

```{r}
sql = paste('SELECT albumid, COUNT(trackid)', 'FROM tracks GROUP BY albumid', 'HAVING albumid=1')
dbGetQuery(db, sql)
```

11. Quais são os nomes de cada faixa com os respectivos títulos dos álbums?

```{r}
sql = paste('SELECT trackid, name, title FROM tracks', 'INNER JOIN albums ON albums.albumid=tracks.albumid')
dbGetQuery(db, sql)
```
